# =============================================================================
# Quaxis Solo Miner - Пример конфигурации сервера
# Universal AuxPoW Core - автономный режим
# =============================================================================
# Скопируйте этот файл в ~/.config/quaxis/quaxis.toml и настройте
# =============================================================================

[server]
# IP адрес для прослушивания подключений ASIC
bind_address = "0.0.0.0"
# TCP порт для подключений ASIC
port = 3333
# Максимальное количество одновременных подключений
max_connections = 10
# Размер буфера TCP сокета (байт)
socket_buffer_size = 65536

[parent_chain]
# Источник заголовков: "p2p", "fibre" или "trusted"
headers_source = "p2p"
# Seed ноды для P2P подключения
seed_nodes = ["seed.bitcoin.sipa.be", "dnsseed.bluematt.me", "seed.bitcoinstats.com"]
# Интервал обновления MTP (секунды)
mtp_refresh_seconds = 60
# Адрес для получения награды за найденный блок
# Формат: P2WPKH (Native SegWit) - bc1q...
# ВАЖНО: Замените на свой адрес!
payout_address = "bc1qrpamkfhuragxrfx8a9c28drcwygdwsgkzk2ykq"

[mining]
# Уникальный тег в coinbase транзакции (до 20 символов ASCII)
# Используется для идентификации ваших блоков в блокчейне
coinbase_tag = "quaxis"

# Размер extranonce в байтах (4-8)
# 6 байт = 2^48 вариантов = достаточно на 589 лет при 90 TH/s
extranonce_size = 6

# Количество заданий в очереди
# Меньше = stale work ниже, но требует частой отправки
job_queue_size = 100

# Spy Mining: начинать майнинг до полной валидации блока
# Экономит 150-1500 мс на каждом новом блоке
use_spy_mining = true

# Использовать минимально допустимый timestamp (MTP + 1)
use_mtp_timestamp = true

# Майнить только пустые блоки (только coinbase, без транзакций)
# Ускоряет сборку блока и его распространение
empty_blocks = true

# =============================================================================
# Version Rolling (AsicBoost) — +15-20% производительности
# =============================================================================
# Использует биты 13-28 поля version как дополнительный nonce
# =============================================================================

[version_rolling]
# Включить version rolling
enabled = true

# Маска для rolling битов (биты 13-28)
# По умолчанию: 0x1FFFE000
version_mask = 0x1FFFE000

# Базовая версия блока (BIP9)
# По умолчанию: 0x20000000
version_base = 0x20000000

# =============================================================================
# Health Monitoring (Predictive Maintenance) — +5-15% uptime
# =============================================================================
# Мониторинг здоровья ASIC и предсказание сбоев
# =============================================================================

[health]
# Включить мониторинг здоровья
enabled = true

# Интервал сбора метрик (секунды)
collection_interval = 5

# Пороги температуры (°C)
temp_warning = 75.0
temp_critical = 85.0
temp_emergency = 95.0

# Пороги падения хешрейта (%)
hashrate_warning_drop = 10.0
hashrate_critical_drop = 25.0

# Пороги error rate (%)
error_rate_warning = 1.0
error_rate_critical = 5.0

# Автоматические действия
auto_throttle = true    # Снижение частоты при перегреве
auto_restart = true     # Перезапуск при падении хешрейта

# Cooldown после перезапуска (секунды)
restart_cooldown = 300

# =============================================================================
# DEPRECATED: Nonce Distribution
# =============================================================================
# Эта секция устарела. Уникальность хешей обеспечивается через extranonce,
# который уникален для каждого ASIC-соединения.
# 
# Каждое подключение ASIC получает уникальный extranonce при подключении,
# что гарантирует отсутствие коллизий в пространстве хешей.
# Разбиение nonce между чипами НЕ требуется.
# =============================================================================
# [nonce]
# chips_per_asic = 114
# asic_count = 3
# distribution_strategy = "sequential"
# random_seed = 0

[shm]
# Использовать Shared Memory для уведомлений о новых блоках
enabled = true

# Путь к объекту Shared Memory
path = "/quaxis_block"

# Адаптивный spin-wait (3-фазный алгоритм)
# Фаза 1: spin с pause — минимальная латентность, высокое CPU
# Фаза 2: yield — средняя латентность, среднее CPU  
# Фаза 3: sleep — выше латентность, низкое CPU
adaptive_spin_enabled = true

# Количество итераций фазы 1 (spin)
spin_phase1_iterations = 2000

# Количество итераций фазы 2 (yield)
spin_phase2_iterations = 2000

# Время sleep в микросекундах (фаза 3)
sleep_us = 200

# =============================================================================
# Logging — Терминальный вывод статуса
# =============================================================================
# Настройки терминального репортёра статуса
# =============================================================================

[logging]
# Интервал обновления экрана (миллисекунды)
refresh_interval_ms = 1000

# Уровень логирования: error, warn, info, debug
level = "info"

# Размер истории событий
event_history = 200

# Использовать цветной вывод
color = true

# Показывать хешрейт
show_hashrate = true

# Подсвечивать найденные блоки
highlight_found_blocks = true

# Показывать счётчики блоков по chains
show_chain_block_counts = true

# =============================================================================
# Надёжность и Fallback
# =============================================================================
# Автоматическое переключение на резервные источники при недоступности
# основного (SHM → ZMQ → Stratum Pool)
# =============================================================================

[fallback]
# Включить систему fallback
enabled = true

# ZMQ fallback (если SHM недоступен)
[fallback.zmq]
enabled = true
endpoint = "tcp://127.0.0.1:28332"

# Stratum fallback (если Bitcoin Core полностью недоступен)
[fallback.stratum]
enabled = true
url = "stratum+tcp://solo.ckpool.org:3333"
user = "YOUR_BITCOIN_ADDRESS"
password = "x"

# Таймауты fallback
[fallback.timeouts]
# Интервал проверки здоровья primary источника (миллисекунды)
primary_health_check_ms = 1000
# Таймаут primary источника до переключения (миллисекунды)
primary_timeout_ms = 5000
# Задержка перед повторным подключением (миллисекунды)
reconnect_delay_ms = 1000

# =============================================================================
# UDP Relay (FIBRE протокол) - Сверхбыстрое получение блоков
# =============================================================================
# FIBRE обеспечивает получение блоков за 100-300 мс вместо 500-2000 мс
# через стандартный Bitcoin P2P протокол.
# =============================================================================

[relay]
# Включить UDP relay для быстрого получения блоков
enabled = false

# Локальный UDP порт для прослушивания
local_port = 8336

# Bandwidth лимит (Mbps)
# Ограничивает скорость приёма данных от relay пиров
bandwidth_limit = 100

# Таймаут реконструкции блока (миллисекунды)
# Если блок не собран за это время - используем данные от Bitcoin P2P
reconstruction_timeout = 5000

# Forward Error Correction (FEC)
# Позволяет восстанавливать данные при потере UDP пакетов
fec_enabled = true

# Избыточность FEC (0.5 = 50% дополнительных пакетов)
# Больше = надёжнее, но больше трафика
fec_overhead = 0.5

# FIBRE пиры - серверы для получения блоков
# trusted = true означает что header от этого пира используется для Spy Mining

[[relay.peers]]
host = "fibre.asia.bitcoinfibre.org"
port = 8336
trusted = true

[[relay.peers]]
host = "fibre.eu.bitcoinfibre.org"
port = 8336
trusted = true

[[relay.peers]]
host = "fibre.us.bitcoinfibre.org"
port = 8336
trusted = true

# =============================================================================
# Merged Mining (AuxPoW) — Дополнительный доход $60-105/месяц
# =============================================================================
# Одновременный майнинг Bitcoin и 6+ SHA-256 монет БЕЗ потери хешрейта.
# Все auxiliary chains используют тот же PoW что и Bitcoin.
# =============================================================================

[merged_mining]
# Включить merged mining
enabled = true

# Интервал проверки состояния chains (секунды)
health_check_interval = 60

# -----------------------------------------------------------------------------
# Fractal Bitcoin (FB) — Ожидаемый доход: $25-41/месяц
# -----------------------------------------------------------------------------
[[merged_mining.chains]]
name = "fractal"
enabled = true
rpc_url = "http://127.0.0.1:8332"
rpc_user = "quaxis"
rpc_password = "your_fractal_rpc_password"
# КРИТИЧЕСКИ ВАЖНО: Укажите ваш адрес для получения награды!
# Формат: Fractal Bitcoin использует тот же формат что и Bitcoin
payout_address = "bc1q..."  # ← Замените на свой Fractal Bitcoin адрес!
priority = 100
rpc_timeout = 30
update_interval = 5

# -----------------------------------------------------------------------------
# RSK/Rootstock (RBTC) — Ожидаемый доход: $10-20/месяц
# -----------------------------------------------------------------------------
[[merged_mining.chains]]
name = "rsk"
enabled = true
rpc_url = "http://127.0.0.1:4444"
rpc_user = ""
rpc_password = ""
# КРИТИЧЕСКИ ВАЖНО: Укажите ваш RSK/Ethereum-style адрес!
# Формат: 0x... (42 символа, checksummed)
payout_address = "0x..."  # ← Замените на свой RSK адрес!
priority = 90
rpc_timeout = 30
update_interval = 5

# -----------------------------------------------------------------------------
# Syscoin (SYS) — Ожидаемый доход: $8-12/месяц
# -----------------------------------------------------------------------------
[[merged_mining.chains]]
name = "syscoin"
enabled = true
rpc_url = "http://127.0.0.1:8370"
rpc_user = "quaxis"
rpc_password = "your_syscoin_rpc_password"
# КРИТИЧЕСКИ ВАЖНО: Укажите ваш Syscoin bech32 адрес!
# Формат: sys1q... (Native SegWit)
payout_address = "sys1q..."  # ← Замените на свой Syscoin адрес!
priority = 80
rpc_timeout = 30
update_interval = 5

# -----------------------------------------------------------------------------
# Namecoin (NMC) — Ожидаемый доход: $8-10/месяц
# -----------------------------------------------------------------------------
[[merged_mining.chains]]
name = "namecoin"
enabled = true
rpc_url = "http://127.0.0.1:8336"
rpc_user = "quaxis"
rpc_password = "your_namecoin_rpc_password"
# КРИТИЧЕСКИ ВАЖНО: Укажите ваш Namecoin адрес!
# Формат: N... (legacy) или nc1q... (bech32)
payout_address = "N..."  # ← Замените на свой Namecoin адрес!
priority = 70
rpc_timeout = 30
update_interval = 5

# -----------------------------------------------------------------------------
# Elastos (ELA) — Ожидаемый доход: $3-5/месяц
# -----------------------------------------------------------------------------
[[merged_mining.chains]]
name = "elastos"
enabled = true
rpc_url = "http://127.0.0.1:20336"
rpc_user = "quaxis"
rpc_password = "your_elastos_rpc_password"
# КРИТИЧЕСКИ ВАЖНО: Укажите ваш Elastos адрес!
# Формат: E... (base58 encoded)
payout_address = "E..."  # ← Замените на свой Elastos адрес!
priority = 60
rpc_timeout = 30
update_interval = 5

# -----------------------------------------------------------------------------
# Hathor (HTR) — Ожидаемый доход: $5-15/месяц
# -----------------------------------------------------------------------------
[[merged_mining.chains]]
name = "hathor"
enabled = true
rpc_url = "http://127.0.0.1:8080"
rpc_user = ""
rpc_password = ""
# КРИТИЧЕСКИ ВАЖНО: Укажите ваш Hathor адрес!
# Формат: H... (base58 encoded)
payout_address = "H..."  # ← Замените на свой Hathor адрес!
priority = 50
rpc_timeout = 30
update_interval = 5

# -----------------------------------------------------------------------------
# VCash (XVC) — Ожидаемый доход: <$1/месяц
# -----------------------------------------------------------------------------
[[merged_mining.chains]]
name = "vcash"
enabled = false  # Отключено по умолчанию из-за низкой доходности
rpc_url = "http://127.0.0.1:5739"
rpc_user = "quaxis"
rpc_password = "your_vcash_rpc_password"
# КРИТИЧЕСКИ ВАЖНО: Укажите ваш VCash адрес!
# Формат: V... (base58 encoded)
payout_address = "V..."  # ← Замените на свой VCash адрес!
priority = 10
rpc_timeout = 30
update_interval = 5

# =============================================================================
# Дополнительные Merged Mining монеты
# =============================================================================

# -----------------------------------------------------------------------------
# Myriad (XMY) — Multi-algo монета (SHA256 merged mining)
# -----------------------------------------------------------------------------
[[merged_mining.chains]]
name = "myriad"
enabled = true
rpc_url = "http://127.0.0.1:10888"
rpc_user = "quaxis"
rpc_password = "your_myriad_rpc_password"
# КРИТИЧЕСКИ ВАЖНО: Укажите ваш Myriad адрес!
# Формат: M... (base58 encoded)
payout_address = "M..."  # ← Замените на свой Myriad адрес!
priority = 40
rpc_timeout = 30
update_interval = 5

# -----------------------------------------------------------------------------
# Huntercoin (HUC) — Игровая монета
# -----------------------------------------------------------------------------
[[merged_mining.chains]]
name = "huntercoin"
enabled = true
rpc_url = "http://127.0.0.1:8398"
rpc_user = "quaxis"
rpc_password = "your_huntercoin_rpc_password"
# КРИТИЧЕСКИ ВАЖНО: Укажите ваш Huntercoin адрес!
# Формат: H... (base58 encoded)
payout_address = "H..."  # ← Замените на свой Huntercoin адрес!
priority = 30
rpc_timeout = 30
update_interval = 5

# -----------------------------------------------------------------------------
# Emercoin (EMC) — DNS, SSL, SSH на блокчейне
# -----------------------------------------------------------------------------
[[merged_mining.chains]]
name = "emercoin"
enabled = true
rpc_url = "http://127.0.0.1:6662"
rpc_user = "quaxis"
rpc_password = "your_emercoin_rpc_password"
# КРИТИЧЕСКИ ВАЖНО: Укажите ваш Emercoin адрес!
# Формат: E... (base58 encoded)
payout_address = "E..."  # ← Замените на свой Emercoin адрес!
priority = 50
rpc_timeout = 30
update_interval = 5

# -----------------------------------------------------------------------------
# Unobtanium (UNO) — Редкая монета (250,000 max supply)
# -----------------------------------------------------------------------------
[[merged_mining.chains]]
name = "unobtanium"
enabled = true
rpc_url = "http://127.0.0.1:65530"
rpc_user = "quaxis"
rpc_password = "your_unobtanium_rpc_password"
# КРИТИЧЕСКИ ВАЖНО: Укажите ваш Unobtanium адрес!
# Формат: u... (base58 encoded)
payout_address = "u..."  # ← Замените на свой Unobtanium адрес!
priority = 35
rpc_timeout = 30
update_interval = 5

# -----------------------------------------------------------------------------
# Terracoin (TRC) — Старый форк Bitcoin
# -----------------------------------------------------------------------------
[[merged_mining.chains]]
name = "terracoin"
enabled = true
rpc_url = "http://127.0.0.1:13332"
rpc_user = "quaxis"
rpc_password = "your_terracoin_rpc_password"
# КРИТИЧЕСКИ ВАЖНО: Укажите ваш Terracoin адрес!
# Формат: 1... (legacy base58 encoded)
payout_address = "1..."  # ← Замените на свой Terracoin адрес!
priority = 25
rpc_timeout = 30
update_interval = 5
